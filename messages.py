import datetime


weekdays = ['–ü–Ω','–í—Ç','–°—Ä','–ß—Ç','–ü—Ç','–°–±','–í—Å']
months = ['–Ø–Ω–≤–∞—Ä—è','–§–µ–≤—Ä–∞–ª—è','–ú–∞—Ä—Ç–∞','–ê–ø—Ä–µ–ª—è','–ú–∞—è','–ò—é–Ω—è','–ò—é–ª—è','–ê–≤–≥—É—Å—Ç–∞','–°–µ–Ω—Ç—è–±—Ä—è','–û–∫—Ç—è–±—Ä—è','–ù–æ—è–±—Ä—è','–î–µ–∫–∞–±—Ä—è']


ERROR_START = '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑'
WRITE_CITY = '–ù–∞–ø–∏—à–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ö–æ—á–µ—à—å —É–∑–Ω–∞—Ç—å –ø–æ–≥–æ–¥—É'
SELECT_CITY = '–í—ã–±–µ—Ä–∏ –≥–æ—Ä–æ–¥ –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö'
SELECT_CITY_ERROR = '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: –≥–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω\n–í–≤–µ–¥–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –∑–∞–Ω–æ–≤–æ'
SUCCESS_CITY_CONNECTED = '‚úÖ –ì–æ—Ä–æ–¥ —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –≤–∞—à–µ–º—É –∞–∫–∫–∞—É–Ω—Ç—É'
ERROR_CITY_CONNECTED = '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞, –Ω–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–∏–≤—è–∑–∞—Ç—å –≥–æ—Ä–æ–¥ –∫ –≤–∞—à–µ–º—É –∞–∫–∫–∞—É–Ω—Ç—É'
ABOUT = '–≠—Ç–æ—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –±–æ—Ç —Å–æ–∑–¥–∞–Ω –ø–æ –ª–∏—á–Ω–æ–π –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–µ @oshkov\n\n–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ API –æ—Ç <a href="https://www.gismeteo.ru/">Gismeteo</a>'
NOTIFICATION_ON = '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ãüîî\n\n–í—ã –±—É–¥–µ—Ç–µ –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ 7.00 –∏ 21.00 –ø–æ –º—Å–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å'
NOTIFICATION_OFF = '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—ã–∫–ª—é—á–µ–Ω—ãüîï'
LOADING = '–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...'


async def WEATHER_NOW(weather):
    # –î–∞–Ω–Ω—ã–µ –æ –ø–æ–≥–æ–¥–µ
    data = weather['data']

    # –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    name_p = data['city']['nameP']
    emoji = data['icon']['emoji']
    description = data['description']
    wind_speed = round(data['wind']['speed']['m_s'])

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
    temperature = round(data['temperature']['air']['C'])
    if temperature > 0:
        temperature = f"+{temperature}"

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –ø–æ –æ—â—É—â–µ–Ω–∏—è–º
    temperature_comfort = round(data['temperature']['comfort']['C'])
    if temperature_comfort > 0:
        temperature_comfort = f"+{temperature_comfort}"

    return f'–ü–æ–≥–æ–¥–∞ {name_p} —Å–µ–π—á–∞—Å:\n\n<b>{emoji} {description}, {temperature}¬∞, {wind_speed} –º/—Å</b>\n\n–ü–æ –æ—â—É—â–µ–Ω–∏—è–º {temperature_comfort}'


async def WEATHER_TODAY(weather):
    # –î–∞–Ω–Ω—ã–µ –æ –ø–æ–≥–æ–¥–µ
    data = weather['data']

    # –ù–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –≤ –ø—Ä–µ–¥–ª–æ–∂–Ω–æ–º –ø–∞–¥–µ–∂–µ
    name_p = data[0]['city']['nameP']

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç—ã —Å–µ–≥–æ–¥–Ω—è –≤ —Ñ–æ—Ä–º–∞—Ç: –í—Ç, 5 –º–∞—Ä—Ç–∞
    date = data[0]['date']['local']
    date_obj = datetime.datetime.strptime(str(date), "%Y-%m-%dT%H:%M:%SZ")
    weekday = weekdays[date_obj.weekday()]
    day = date_obj.day
    month = months[date_obj.month - 1]
    date_today = f'{weekday}, {day} {month}'

    indexes = [2,3,4,5,6,7]
    times = []
    emojis = []
    temperatures = []
    descriptions = []
    wind_speeds = []

    for index in indexes:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫
        time = data[index]['date']['local'][11:16].replace(":", ".")
        times.append(time)

        # –ü–æ–ª—É—á–µ–Ω–∏–µ —ç–º–æ–¥–∑–∏
        emoji = data[index]['icon']['emoji']
        emojis.append(emoji)

        # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä
        temperature = round(data[index]['temperature']['air']['C'])
        temperatures.append(temperature)

        # –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏–π –ø–æ–≥–æ–¥—ã
        description = data[index]['description']
        descriptions.append(description)

        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–µ—Ç—Ä–∞
        wind_speed = round(data[index]['wind']['speed']['m_s'])
        wind_speeds.append(wind_speed)

    return f'–ü–æ–≥–æ–¥–∞ {name_p} —Å–µ–≥–æ–¥–Ω—è ({date_today}):\n\n<b>{times[0]}:</b> {emojis[0]} {temperatures[0]}¬∞, {descriptions[0]}, {wind_speeds[0]} –º/—Å\n<b>{times[1]}:</b> {emojis[1]} {temperatures[1]}¬∞, {descriptions[1]}, {wind_speeds[1]} –º/—Å\n<b>{times[2]}:</b> {emojis[2]} {temperatures[2]}¬∞, {descriptions[2]}, {wind_speeds[2]} –º/—Å\n<b>{times[3]}:</b> {emojis[3]} {temperatures[3]}¬∞, {descriptions[3]}, {wind_speeds[3]} –º/—Å\n<b>{times[4]}:</b> {emojis[4]} {temperatures[4]}¬∞, {descriptions[4]}, {wind_speeds[4]} –º/—Å\n<b>{times[5]}:</b> {emojis[5]} {temperatures[5]}¬∞, {descriptions[5]}, {wind_speeds[5]} –º/—Å'


async def WEATHER_TOMORROW(weather):
    # –î–∞–Ω–Ω—ã–µ –æ –ø–æ–≥–æ–¥–µ
    data = weather['data']

    # –ù–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –≤ –ø—Ä–µ–¥–ª–æ–∂–Ω–æ–º –ø–∞–¥–µ–∂–µ
    name_p = data[0]['city']['nameP']

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç—ã —Å–µ–≥–æ–¥–Ω—è –≤ —Ñ–æ—Ä–º–∞—Ç: –í—Ç, 5 –º–∞—Ä—Ç–∞
    date = data[9]['date']['local']
    date_obj = datetime.datetime.strptime(str(date), "%Y-%m-%dT%H:%M:%SZ")
    weekday = weekdays[date_obj.weekday()]
    day = date_obj.day
    month = months[date_obj.month - 1]
    date_tomorrow = f'{weekday}, {day} {month}'

    indexes = [10,11,12,13,14,15]
    times = []
    emojis = []
    temperatures = []
    descriptions = []
    wind_speeds = []

    for index in indexes:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫
        time = data[index]['date']['local'][11:16].replace(":", ".")
        times.append(time)

        # –ü–æ–ª—É—á–µ–Ω–∏–µ —ç–º–æ–¥–∑–∏
        emoji = data[index]['icon']['emoji']
        emojis.append(emoji)

        # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä
        temperature = round(data[index]['temperature']['air']['C'])
        temperatures.append(temperature)

        # –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏–π –ø–æ–≥–æ–¥—ã
        description = data[index]['description']
        descriptions.append(description)

        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–µ—Ç—Ä–∞
        wind_speed = round(data[index]['wind']['speed']['m_s'])
        wind_speeds.append(wind_speed)

    return f'–ü–æ–≥–æ–¥–∞ {name_p} –∑–∞–≤—Ç—Ä–∞ ({date_tomorrow}):\n\n<b>{times[0]}:</b> {emojis[0]} {temperatures[0]}¬∞, {descriptions[0]}, {wind_speeds[0]} –º/—Å\n<b>{times[1]}:</b> {emojis[1]} {temperatures[1]}¬∞, {descriptions[1]}, {wind_speeds[1]} –º/—Å\n<b>{times[2]}:</b> {emojis[2]} {temperatures[2]}¬∞, {descriptions[2]}, {wind_speeds[2]} –º/—Å\n<b>{times[3]}:</b> {emojis[3]} {temperatures[3]}¬∞, {descriptions[3]}, {wind_speeds[3]} –º/—Å\n<b>{times[4]}:</b> {emojis[4]} {temperatures[4]}¬∞, {descriptions[4]}, {wind_speeds[4]} –º/—Å\n<b>{times[5]}:</b> {emojis[5]} {temperatures[5]}¬∞, {descriptions[5]}, {wind_speeds[5]} –º/—Å'


async def WEATHER_10_DAYS(weather):
    # –î–∞–Ω–Ω—ã–µ –æ –ø–æ–≥–æ–¥–µ
    data = weather['data']

    # –ù–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –≤ –ø—Ä–µ–¥–ª–æ–∂–Ω–æ–º –ø–∞–¥–µ–∂–µ
    name_p = data[0]['city']['nameP']

    indexes = [5,13,21,29,37,45,53,61,69,77]
    dates = []
    emojis = []
    temperatures = []
    descriptions = []
    wind_speeds = []

    for index in indexes:
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç—ã —Å–µ–≥–æ–¥–Ω—è –≤ —Ñ–æ—Ä–º–∞—Ç: –í—Ç, 5 –º–∞—Ä—Ç–∞
        date = data[index]['date']['local']
        date_obj = datetime.datetime.strptime(str(date), "%Y-%m-%dT%H:%M:%SZ")
        weekday = weekdays[date_obj.weekday()]
        day = date_obj.day
        month = months[date_obj.month - 1]
        dates.append(f'{weekday}, {day} {month}')

        # –ü–æ–ª—É—á–µ–Ω–∏–µ —ç–º–æ–¥–∑–∏
        emoji = data[index]['icon']['emoji']
        emojis.append(emoji)

        # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä
        temperature = round(data[index]['temperature']['air']['C'])
        temperatures.append(temperature)

        # –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏–π –ø–æ–≥–æ–¥—ã
        description = data[index]['description']
        descriptions.append(description)

        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–µ—Ç—Ä–∞
        wind_speed = round(data[index]['wind']['speed']['m_s'])
        wind_speeds.append(wind_speed)

    return f'–ü–æ–≥–æ–¥–∞ {name_p} –Ω–∞ 10 –¥–Ω–µ–π:\n\n<b>{dates[0]}:</b> {emojis[0]} {temperatures[0]}¬∞, {descriptions[0]}, {wind_speeds[0]} –º/—Å\n<b>{dates[1]}:</b> {emojis[1]} {temperatures[1]}¬∞, {descriptions[1]}, {wind_speeds[1]} –º/—Å\n<b>{dates[2]}:</b> {emojis[2]} {temperatures[2]}¬∞, {descriptions[2]}, {wind_speeds[2]} –º/—Å\n<b>{dates[3]}:</b> {emojis[3]} {temperatures[3]}¬∞, {descriptions[3]}, {wind_speeds[3]} –º/—Å\n<b>{dates[4]}:</b> {emojis[4]} {temperatures[4]}¬∞, {descriptions[4]}, {wind_speeds[4]} –º/—Å\n<b>{dates[5]}:</b> {emojis[5]} {temperatures[5]}¬∞, {descriptions[5]}, {wind_speeds[5]} –º/—Å\n<b>{dates[6]}:</b> {emojis[6]} {temperatures[6]}¬∞, {descriptions[6]}, {wind_speeds[6]} –º/—Å\n<b>{dates[7]}:</b> {emojis[7]} {temperatures[7]}¬∞, {descriptions[7]}, {wind_speeds[7]} –º/—Å\n<b>{dates[8]}:</b> {emojis[8]} {temperatures[8]}¬∞, {descriptions[8]}, {wind_speeds[8]} –º/—Å\n<b>{dates[9]}:</b> {emojis[9]} {temperatures[9]}¬∞, {descriptions[9]}, {wind_speeds[9]} –º/—Å'